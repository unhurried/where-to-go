!function(){"use strict";angular.module("whereToGo",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ui.bootstrap","toastr","LocalStorageModule","datatables","uiGmapgoogle-maps","datatables"])}(),function(){"use strict";function e(e,a,t,o,l){var n=this;n.dtOptions=o.newOptions(),n.DTColumnDefs=[l.newColumnDef(2).withOption("sType","num"),l.newColumnDef(3).withOption("sType","num")],n.geocode=function(e,a){(null==e||""==e)&&a({});var t=new google.maps.Geocoder;t.geocode({address:e},function(e,t){if("OK"==t){var o=e[0].geometry.location.lat(),l=e[0].geometry.location.lng();a({latitude:o,longitude:l})}})},n.home=t.get("home"),n.home=n.home||{},n.homeForm=n.home,e.$watch(function(){return n.home},function(){t.set("home",n.home)},!0),n.showHomeForm=function(){n.homeModalInstance=a.open({templateUrl:"homeForm",scope:e})},n.geocodeHome=function(){n.geocode(n.homeForm.name,function(a){n.homeForm.latitude=a.latitude,n.homeForm.longitude=a.longitude,e.$apply()})},n.registerHome=function(){n.home.name=n.homeForm.name,n.home.latitude=n.homeForm.latitude,n.home.longitude=n.homeForm.longitude,n.homeModalInstance.close()},n.placeMap=t.get("placeMap"),n.placeMap=n.placeMap||{},e.$watch(function(){return n.placeMap},function(){t.set("placeMap",n.placeMap)},!0),n.deletePlace=function(e){delete n.placeMap[e],n.placeModalInstance.close()},n.recalculate=function(){var a=new google.maps.LatLng(n.home.latitude,n.home.longitude),t=[];angular.forEach(n.placeMap,function(e){t.push(new google.maps.LatLng(e.latitude,e.longitude))});var o=new google.maps.DistanceMatrixService;o.getDistanceMatrix({origins:[a],destinations:t,travelMode:google.maps.TravelMode.DRIVING,avoidHighways:!1,avoidTolls:!1},function(a,t){if(t==google.maps.DistanceMatrixStatus.OK){var o=0;angular.forEach(n.placeMap,function(e){var t=a.rows[0].elements[o];e.distance=t.distance.value,e.duration=t.duration.value,o++}),e.$apply()}})},n.map={center:{latitude:n.home.latitude,longitude:n.home.longitude},zoom:10},n.showPlaceForm=function(t){null==t?n.placeForm=angular.copy(n.home):n.placeForm=angular.copy(n.placeMap[t]),n.placeModalInstance=a.open({templateUrl:"placeForm",scope:e}),n.placeModalInstance.rendered.then(function(){if(void 0!==n.placeFormMap.control.getGMap){var e=n.placeFormMap.control.getGMap();google.maps.event.trigger(e,"resize")}n.placeFormMap.center={latitude:n.placeForm.latitude,longitude:n.placeForm.longitude},n.placeFormMap.marker=n.placeForm})},n.geocodePlace=function(){n.geocode(n.placeForm.name,function(a){n.placeForm.latitude=a.latitude,n.placeForm.longitude=a.longitude,n.placeFormMap.center={latitude:n.placeForm.latitude,longitude:n.placeForm.longitude},e.$apply()})},n.createOrUpdatePlace=function(){var e=angular.copy(n.placeForm);null==e.id&&(e.id=UUIDjs.create().toString()),n.placeMap[e.id]=e,n.placeForm={},n.placeModalInstance.close()},n.placeFormMap={},n.placeFormMap.style={display:"block"},n.placeFormMap.control={},n.placeFormMap.toggle=function(){"none"==n.placeFormMap.style.display?n.placeFormMap.style={display:"block"}:n.placeFormMap.style={display:"none"}},n.placeFormMap.setMarker=function(a,t,o){n.placeForm.latitude=o[0].latLng.lat(),n.placeForm.longitude=o[0].latLng.lng(),e.$apply()}}e.$inject=["$scope","$modal","localStorageService","DTOptionsBuilder","DTColumnDefBuilder"],angular.module("whereToGo").controller("MainController",e)}(),function(){"use strict";function e(e){e.debug("runBlock end")}e.$inject=["$log"],angular.module("whereToGo").run(e)}(),function(){"use strict";function e(e,a){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}),a.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("whereToGo").config(e)}(),function(){"use strict";angular.module("whereToGo").constant("malarkey",malarkey).constant("moment",moment)}(),function(){"use strict";function e(e,a){e.debugEnabled(!0),a.allowHtml=!0,a.timeOut=3e3,a.positionClass="toast-top-right",a.preventDuplicates=!0,a.progressBar=!0}e.$inject=["$logProvider","toastrConfig"],angular.module("whereToGo").config(e)}(),angular.module("whereToGo").run(["$templateCache",function(e){e.put("app/main/main.html",'<div class="container"><h1>Where To Go</h1><div class="row" style="margin:20px;"><span ng-if="main.home.latitude != null && main.home.longitude != null" class="label label-default" style="margin-right:12px">Home is regsterd</span> <input ng-if="main.home.latitude != null && main.home.longitude != null" type="button" value="Update" class="btn btn-primary" style="margin-right:12px" ng-click="main.showHomeForm()"> <input ng-if="main.home.latitude != null && main.home.longitude != null" type="button" value="Recalculate" class="btn btn-primary" ng-click="main.recalculate()"> <span ng-if="main.home.latitude == null || main.home.longitude == null" class="label label-danger" style="margin-right:12px">Home is not regsterd</span> <input ng-if="main.home.latitude == null || main.home.longitude == null" type="button" value="Register" class="btn btn-primary" ng-click="main.showHomeForm()"> <input type="button" value="New Place" class="btn btn-primary pull-right" ng-click="main.showPlaceForm()"></div><table datatable="ng" dt-options="main.dtOptions" dt-column-defs="main.DTColumnDefs" class="table table-striped"><thead><tr><th>Category</th><th>Name</th><th>Distance (km)</th><th>Duration (min)</th><th>Memo</th></tr></thead><tr ng-repeat="(id, place) in main.placeMap" ng-click="main.showPlaceForm(place.id)"><td>{{ place.category }}</td><td><a target="_blank" href="{{ place.url }}">{{ place.name }}</a></td><td>{{ (place.distance / 1000).toFixed(0) }}</td><td>{{ (place.duration / 60 ).toFixed(0) }}</td><td>{{ place.memo }}</td></tr></table><div style="margin-top:10px;"><ui-gmap-google-map center="main.map.center" zoom="main.map.zoom" idkey="0"><ui-gmap-marker ng-repeat="(id, place) in main.placeMap" coords="{latitude:place.latitude, longitude:place.longitude}" options="{text:place.name}" events="marker.events" idkey="place.id"><ui-gmap-window show="true">{{ place.name }}</ui-gmap-window></ui-gmap-marker></ui-gmap-google-map></div><script type="text/ng-template" id="homeForm"><div class="modal-body"> <div style="margin: 20px;"> <form class="form-horizontal" ng-submit="main.registerHome()"> <div class="form-group form-inline"> <input type="text" placeholder="name" class="form-control" style="width:250px;margin-right:12px;" ng-model="main.homeForm.name"> <input type="button" value="Geocode" class="btn" ng-click="main.geocodeHome()"> </div> <div class="form-group form-inline"> <input type="text" placeholder="latitude" class="form-control" style="width:120px;margin-right:12px;" ng-model="main.homeForm.latitude"> <input type="text" placeholder="longitude" class="form-control" style="width:120px;margin-right:12px;" ng-model="main.homeForm.longitude"> </div> <div class="form-group"> <input type="submit" value="Register" class="btn btn-primary"> </div> </form> </div> </div></script><script type="text/ng-template" id="placeForm"><div class="modal-body"> <div style="margin: 20px;"> <form class="form-horizontal" ng-submit="main.createOrUpdatePlace()"> <div class="form-group form-inline"> <input type="text" placeholder="category" class="form-control" style="width:120px;margin-right:12px;" ng-model="main.placeForm.category"> <input type="text" placeholder="name" class="form-control" style="width:200px;margin-right:12px;" ng-model="main.placeForm.name"> <input type="button" value="Geocode" class="btn" ng-click="main.geocodePlace()"> </div> <div class="form-group form-inline"> <input type="text" placeholder="latitude" class="form-control" style="width:120px;margin-right:12px;" ng-model="main.placeForm.latitude"> <input type="text" placeholder="longitude" class="form-control" style="width:120px;margin-right:12px;" ng-model="main.placeForm.longitude"> <input type="button" value="Toggle Map" class="btn" ng-click="main.placeFormMap.toggle()"> </div> <div id="mapChooser" class="form-group" ng-style="main.placeFormMap.style" > <ui-gmap-google-map pan="true" center="main.placeFormMap.center" zoom="12" idKey="100" events="{dblclick:main.placeFormMap.setMarker}" control="main.placeFormMap.control" options="{disableDoubleClickZoom:true}"> <ui-gmap-marker coords="main.placeFormMap.marker" idkey="2"></ui-gmap-marker> </ui-gmap-google-map> </div> <div class="form-group"> <input type="text" placeholder="URL" class="form-control" style="width:450px;" ng-model="main.placeForm.url"> </div> <div class="form-group"> <textarea placeholder="memo" class="form-control" style="width:450px" ng-model="main.placeForm.memo"></textarea> </div> <div class="form-group"> <input type="hidden" value="{{ main.placeForm.id }}"> <input ng-if="main.placeForm.id == null" type="submit" value="Add" class="btn btn-primary"> <input ng-if="main.placeForm.id != null" type="submit" value="Update" class="btn btn-primary" style="margin-right:12px;"> <input ng-if="main.placeForm.id != null" ng-click="main.deletePlace(main.placeForm.id)" type="button" value="Delete" class="btn btn-danger"> </div> </form> </div> </div></script></div>')}]);
//# sourceMappingURL=../maps/scripts/app-6c77d8fe7e.js.map
